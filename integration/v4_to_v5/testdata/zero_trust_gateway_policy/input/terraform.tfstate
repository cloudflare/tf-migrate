{
  "version": 4,
  "terraform_version": "1.5.0",
  "serial": 1,
  "lineage": "test-zero-trust-gateway-policy-lineage",
  "outputs": {},
  "resources": [
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "minimal",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "minimal-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-Minimal",
            "description": "Test policy minimal",
            "precedence": 100,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "maximal",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "maximal-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-Maximal",
            "description": "Test policy maximal",
            "precedence": 150,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "with_settings",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "with_settings-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-With Settings",
            "description": "Test policy with_settings",
            "precedence": 200,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "with_nested_blocks",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "with_nested_blocks-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-With Nested Blocks",
            "description": "Test policy with_nested_blocks",
            "precedence": 300,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "complex",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "complex-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-Complex",
            "description": "Test policy complex",
            "precedence": 400,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "simple_resolver",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "simple_resolver-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-Simple Resolver",
            "description": "Test policy simple_resolver",
            "precedence": 500,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "l4_override_detailed",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "l4_override_detailed-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-L4 Override Detailed",
            "description": "Test policy l4_override_detailed",
            "precedence": 1400,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "with_audit_ssh",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "with_audit_ssh-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-With Audit Ssh",
            "description": "Test policy with_audit_ssh",
            "precedence": 1500,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "with_check_session",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "with_check_session-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-With Check Session",
            "description": "Test policy with_check_session",
            "precedence": 1600,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "with_biso",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "with_biso-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-With Biso",
            "description": "Test policy with_biso",
            "precedence": 1700,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "with_payload_log",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "with_payload_log-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-With Payload Log",
            "description": "Test policy with_payload_log",
            "precedence": 1800,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "with_override_ips",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "with_override_ips-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-With Override Ips",
            "description": "Test policy with_override_ips",
            "precedence": 1900,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "with_join",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "with_join-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-With Join",
            "description": "Test policy with_join",
            "precedence": 1000,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "with_interpolation",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "with_interpolation-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-With Interpolation",
            "description": "Test policy with_interpolation",
            "precedence": 1100,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "with_lifecycle",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "with_lifecycle-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-With Lifecycle",
            "description": "Test policy with_lifecycle",
            "precedence": 1200,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "with_prevent_destroy",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "with_prevent_destroy-policy-id",
            "account_id": "test-account-id",
            "name": "cftftest-With Prevent Destroy",
            "description": "Test policy with_prevent_destroy",
            "precedence": 1300,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "policy_configs",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "index_key": "allow_internal",
      "instances": [
        {
          "schema_version": 0,
          "index_key": "allow_internal",
          "attributes": {
            "id": "policy-allow_internal-id",
            "account_id": "test-account-id",
            "name": "cftftest-test-policy-allow_internal",
            "description": "Test allow_internal policy",
            "precedence": 5100,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"allow_internal.cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "policy_configs",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "index_key": "block_malware",
      "instances": [
        {
          "schema_version": 0,
          "index_key": "block_malware",
          "attributes": {
            "id": "policy-block_malware-id",
            "account_id": "test-account-id",
            "name": "cftftest-test-policy-block_malware",
            "description": "Test block_malware policy",
            "precedence": 5200,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"block_malware.cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "policy_configs",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "index_key": "audit_api",
      "instances": [
        {
          "schema_version": 0,
          "index_key": "audit_api",
          "attributes": {
            "id": "policy-audit_api-id",
            "account_id": "test-account-id",
            "name": "cftftest-test-policy-audit_api",
            "description": "Test audit_api policy",
            "precedence": 5300,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"audit_api.cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "environment_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "index_key": "staging",
      "instances": [
        {
          "schema_version": 0,
          "index_key": "staging",
          "attributes": {
            "id": "env-staging-id",
            "account_id": "test-account-id",
            "name": "cftftest-test-policy-staging",
            "description": "Policy for staging environment",
            "precedence": 600,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"staging.cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "environment_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "index_key": "production",
      "instances": [
        {
          "schema_version": 0,
          "index_key": "production",
          "attributes": {
            "id": "env-production-id",
            "account_id": "test-account-id",
            "name": "cftftest-test-policy-production",
            "description": "Policy for production environment",
            "precedence": 601,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"production.cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "environment_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "index_key": "development",
      "instances": [
        {
          "schema_version": 0,
          "index_key": "development",
          "attributes": {
            "id": "env-development-id",
            "account_id": "test-account-id",
            "name": "cftftest-test-policy-development",
            "description": "Policy for development environment",
            "precedence": 602,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"development.cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "environment_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "index_key": "testing",
      "instances": [
        {
          "schema_version": 0,
          "index_key": "testing",
          "attributes": {
            "id": "env-testing-id",
            "account_id": "test-account-id",
            "name": "cftftest-test-policy-testing",
            "description": "Policy for testing environment",
            "precedence": 603,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"testing.cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "tiered_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "index_key": 0,
      "instances": [
        {
          "schema_version": 0,
          "index_key": 0,
          "attributes": {
            "id": "tier-0-id",
            "account_id": "test-account-id",
            "name": "cftftest-test-policy-tier-0",
            "description": "Tier 0 policy",
            "precedence": 700,
            "action": "block",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"tier0.cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "tiered_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "index_key": 1,
      "instances": [
        {
          "schema_version": 0,
          "index_key": 1,
          "attributes": {
            "id": "tier-1-id",
            "account_id": "test-account-id",
            "name": "cftftest-test-policy-tier-1",
            "description": "Tier 1 policy",
            "precedence": 710,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"tier1.cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "tiered_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "index_key": 2,
      "instances": [
        {
          "schema_version": 0,
          "index_key": 2,
          "attributes": {
            "id": "tier-2-id",
            "account_id": "test-account-id",
            "name": "cftftest-test-policy-tier-2",
            "description": "Tier 2 policy",
            "precedence": 720,
            "action": "allow",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] == \"tier2.cf-tf-test.com\")",
            "rule_settings": {}
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "cloudflare_teams_rule",
      "name": "conditional_enabled",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "index_key": 0,
      "instances": [
        {
          "schema_version": 0,
          "index_key": 0,
          "attributes": {
            "id": "conditional-enabled-id",
            "account_id": "test-account-id",
            "name": "cftftest-Security Policy - Enabled",
            "description": "This policy is conditionally created",
            "precedence": 800,
            "action": "block",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "traffic": "any(dns.domains[*] in {\"malware.cf-tf-test.com\" \"phishing.cf-tf-test.com\"})",
            "rule_settings": {
              "block_page_enabled": true,
              "block_page_reason": "This domain is blocked for security reasons"
            }
          }
        }
      ]
    }
  ]
}
