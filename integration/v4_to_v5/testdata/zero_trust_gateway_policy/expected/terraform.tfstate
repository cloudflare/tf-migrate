{
  "lineage": "test-zero-trust-gateway-policy-lineage",
  "outputs": {},
  "resources": [
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy minimal",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "minimal-policy-id",
            "name": "Minimal",
            "precedence": 100,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "minimal",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy maximal",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "maximal-policy-id",
            "name": "Maximal",
            "precedence": 200,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "maximal",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy with_settings",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "with_settings-policy-id",
            "name": "With Settings",
            "precedence": 300,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_settings",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy with_nested_blocks",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "with_nested_blocks-policy-id",
            "name": "With Nested Blocks",
            "precedence": 400,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_nested_blocks",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy complex",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "complex-policy-id",
            "name": "Complex",
            "precedence": 500,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "complex",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy simple_resolver",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "simple_resolver-policy-id",
            "name": "Simple Resolver",
            "precedence": 600,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "simple_resolver",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy l4_override_detailed",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "l4_override_detailed-policy-id",
            "name": "L4 Override Detailed",
            "precedence": 700,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "l4_override_detailed",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy with_audit_ssh",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "with_audit_ssh-policy-id",
            "name": "With Audit Ssh",
            "precedence": 800,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_audit_ssh",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy with_check_session",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "with_check_session-policy-id",
            "name": "With Check Session",
            "precedence": 900,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_check_session",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy with_biso",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "with_biso-policy-id",
            "name": "With Biso",
            "precedence": 1000,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_biso",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy with_payload_log",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "with_payload_log-policy-id",
            "name": "With Payload Log",
            "precedence": 1100,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_payload_log",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy with_override_ips",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "with_override_ips-policy-id",
            "name": "With Override Ips",
            "precedence": 1200,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_override_ips",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy with_join",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "with_join-policy-id",
            "name": "With Join",
            "precedence": 1300,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_join",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy with_interpolation",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "with_interpolation-policy-id",
            "name": "With Interpolation",
            "precedence": 1400,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_interpolation",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy with_lifecycle",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "with_lifecycle-policy-id",
            "name": "With Lifecycle",
            "precedence": 1500,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_lifecycle",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test policy with_prevent_destroy",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "with_prevent_destroy-policy-id",
            "name": "With Prevent Destroy",
            "precedence": 1600,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"example.com\")"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_prevent_destroy",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "index_key": "allow_internal",
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test allow_internal policy",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "policy-allow_internal-id",
            "name": "test-policy-allow_internal",
            "precedence": 100,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"allow_internal.example.com\")"
          },
          "index_key": "allow_internal",
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "policy_configs",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "index_key": "block_malware",
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test block_malware policy",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "policy-block_malware-id",
            "name": "test-policy-block_malware",
            "precedence": 100,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"block_malware.example.com\")"
          },
          "index_key": "block_malware",
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "policy_configs",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "index_key": "audit_api",
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Test audit_api policy",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "policy-audit_api-id",
            "name": "test-policy-audit_api",
            "precedence": 100,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"audit_api.example.com\")"
          },
          "index_key": "audit_api",
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "policy_configs",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "index_key": "staging",
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Policy for staging environment",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "env-staging-id",
            "name": "test-policy-staging",
            "precedence": 600,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"staging.example.com\")"
          },
          "index_key": "staging",
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "environment_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "index_key": "production",
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Policy for production environment",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "env-production-id",
            "name": "test-policy-production",
            "precedence": 600,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"production.example.com\")"
          },
          "index_key": "production",
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "environment_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "index_key": "development",
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Policy for development environment",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "env-development-id",
            "name": "test-policy-development",
            "precedence": 600,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"development.example.com\")"
          },
          "index_key": "development",
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "environment_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "index_key": "testing",
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Policy for testing environment",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "env-testing-id",
            "name": "test-policy-testing",
            "precedence": 600,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"testing.example.com\")"
          },
          "index_key": "testing",
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "environment_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "index_key": 0,
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "block",
            "description": "Tier 0 policy",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "tier-0-id",
            "name": "test-policy-tier-0",
            "precedence": 700,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"tier0.example.com\")"
          },
          "index_key": 0,
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "tiered_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "index_key": 1,
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Tier 1 policy",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "tier-1-id",
            "name": "test-policy-tier-1",
            "precedence": 710,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"tier1.example.com\")"
          },
          "index_key": 1,
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "tiered_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "index_key": 2,
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "allow",
            "description": "Tier 2 policy",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "tier-2-id",
            "name": "test-policy-tier-2",
            "precedence": 720,
            "rule_settings": {},
            "traffic": "any(dns.domains[*] == \"tier2.example.com\")"
          },
          "index_key": 2,
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "tiered_policies",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    },
    {
      "index_key": 0,
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "action": "block",
            "description": "This policy is conditionally created",
            "enabled": true,
            "filters": [
              "dns"
            ],
            "id": "conditional-enabled-id",
            "name": "Security Policy - Enabled",
            "precedence": 800,
            "rule_settings": {
              "block_page_enabled": true,
              "block_reason": "This domain is blocked for security reasons"
            },
            "traffic": "any(dns.domains[*] in {\"malware.example.com\" \"phishing.example.com\"})"
          },
          "index_key": 0,
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "conditional_enabled",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_gateway_policy"
    }
  ],
  "serial": 1,
  "terraform_version": "1.5.0",
  "version": 4
}