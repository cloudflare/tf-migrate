{
  "lineage": "test-zero-trust-access-policy-lineage",
  "outputs": {},
  "resources": [
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "decision": "allow",
            "id": "policy-minimal-id",
            "include": [
              {
                "everyone": {}
              }
            ],
            "name": "Minimal Policy",
            "session_duration": "24h"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "minimal",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "decision": "allow",
            "id": "policy-deprecated-id",
            "include": [
              {
                "everyone": {}
              }
            ],
            "name": "Policy with Deprecated Fields",
            "session_duration": "24h"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_deprecated_fields",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "decision": "allow",
            "id": "policy-email-id",
            "include": [
              {
                "email": {
                  "email": "alice@example.com"
                }
              },
              {
                "email": {
                  "email": "bob@example.com"
                }
              }
            ],
            "name": "Email Array Expansion",
            "session_duration": "24h"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "email_expansion",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "decision": "allow",
            "id": "policy-group-id",
            "include": [
              {
                "group": {
                  "id": "group-id-1"
                }
              },
              {
                "group": {
                  "id": "group-id-2"
                }
              }
            ],
            "name": "Group Array Expansion",
            "session_duration": "24h"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "group_expansion",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "decision": "allow",
            "id": "policy-mixed-id",
            "include": [
              {
                "email": {
                  "email": "admin@example.com"
                }
              },
              {
                "everyone": {}
              },
              {
                "group": {
                  "id": "admins"
                }
              }
            ],
            "name": "Mixed Conditions",
            "session_duration": "24h"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "mixed_conditions",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "decision": "allow",
            "id": "policy-github-id",
            "include": [
              {
                "github": [
                  {
                    "identity_provider_id": "provider-123",
                    "name": "my-org",
                    "teams": [
                      "engineering",
                      "devops"
                    ]
                  }
                ]
              }
            ],
            "name": "GitHub Teams",
            "session_duration": "24h"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "github_teams",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "decision": "allow",
            "exclude": [
              {
                "geo": {
                  "country_code": "CN"
                }
              },
              {
                "geo": {
                  "country_code": "RU"
                }
              }
            ],
            "id": "policy-exclude-id",
            "include": [
              {
                "email": {
                  "email": "allowed@example.com"
                }
              }
            ],
            "name": "Exclude and Require",
            "require": [
              {
                "certificate": {}
              }
            ],
            "session_duration": "24h"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "exclude_require",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "decision": "allow",
            "id": "policy-ip-id",
            "include": [
              {
                "email_domain": {
                  "domain": "example.com"
                }
              },
              {
                "email_domain": {
                  "domain": "company.org"
                }
              },
              {
                "ip": {
                  "ip": "192.168.1.0/24"
                }
              },
              {
                "ip": {
                  "ip": "10.0.0.0/8"
                }
              }
            ],
            "name": "IP and Email Domain",
            "session_duration": "24h"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "ip_email_domain",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "approval_groups": [
              {
                "approvals_needed": 2,
                "email_addresses": [
                  "manager@example.com",
                  "director@example.com"
                ]
              }
            ],
            "decision": "allow",
            "id": "policy-approval-id",
            "include": [
              {
                "everyone": {}
              }
            ],
            "name": "Policy with Approval Group",
            "session_duration": "24h"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_approval_group",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "connection_rules": {
              "ssh": {
                "allow_email_alias": true,
                "usernames": [
                  "admin",
                  "deploy"
                ]
              }
            },
            "decision": "allow",
            "id": "policy-ssh-id",
            "include": [
              {
                "everyone": {}
              }
            ],
            "name": "SSH Policy with Connection Rules",
            "session_duration": "24h"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_connection_rules",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "approval_groups": [
              {
                "approvals_needed": 3,
                "email_addresses": [
                  "ceo@example.com",
                  "cto@example.com"
                ]
              }
            ],
            "connection_rules": {
              "ssh": {
                "allow_email_alias": true,
                "usernames": [
                  "root",
                  "admin"
                ]
              }
            },
            "decision": "allow",
            "exclude": [
              {
                "email_domain": {
                  "domain": "competitor.com"
                }
              },
              {
                "geo": {
                  "country_code": "CN"
                }
              }
            ],
            "id": "policy-complex-id",
            "include": [
              {
                "email": {
                  "email": "user1@example.com"
                }
              },
              {
                "email": {
                  "email": "user2@example.com"
                }
              },
              {
                "everyone": {}
              },
              {
                "github": [
                  {
                    "identity_provider_id": "idp-123",
                    "name": "acme-corp",
                    "teams": [
                      "platform",
                      "security",
                      "devops"
                    ]
                  }
                ]
              },
              {
                "group": {
                  "id": "group-1"
                }
              },
              {
                "group": {
                  "id": "group-2"
                }
              }
            ],
            "name": "Complex Policy",
            "require": [
              {
                "certificate": {}
              },
              {
                "group": {
                  "id": "mfa-enabled"
                }
              }
            ],
            "session_duration": "12h"
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "complex",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_zero_trust_access_policy"
    }
  ],
  "serial": 1,
  "terraform_version": "1.5.0",
  "version": 4
}