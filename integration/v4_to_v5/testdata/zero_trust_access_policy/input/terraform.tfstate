{
  "lineage": "test-zero-trust-access-policy-lineage",
  "outputs": {},
  "resources": [
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "application_id": "app-minimal-id",
            "precedence": 1,
            "id": "policy-minimal-id",
            "name": "Minimal Policy",
            "decision": "allow",
            "include": [{"everyone": true}]
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "minimal",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "zone_id": "zone-123",
            "application_id": "app-456",
            "precedence": 2,
            "id": "policy-deprecated-id",
            "name": "Policy with Deprecated Fields",
            "decision": "allow",
            "include": [{"everyone": true}]
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_deprecated_fields",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "application_id": "app-email-id",
            "precedence": 3,
            "id": "policy-email-id",
            "name": "Email Array Expansion",
            "decision": "allow",
            "include": [{"email": ["alice@example.com", "bob@example.com"]}]
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "email_expansion",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "application_id": "app-group-id",
            "precedence": 4,
            "id": "policy-group-id",
            "name": "Group Array Expansion",
            "decision": "allow",
            "include": [{"group": ["group-id-1", "group-id-2"]}]
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "group_expansion",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "application_id": "app-mixed-id",
            "precedence": 5,
            "id": "policy-mixed-id",
            "name": "Mixed Conditions",
            "decision": "allow",
            "include": [{"everyone": true, "email": ["admin@example.com"], "group": ["admins"]}]
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "mixed_conditions",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "application_id": "app-github-id",
            "precedence": 6,
            "id": "policy-github-id",
            "name": "GitHub Teams",
            "decision": "allow",
            "include": [{"github": [{"name": "my-org", "teams": ["engineering", "devops"], "identity_provider_id": "provider-123"}]}]
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "github_teams",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "application_id": "app-exclude-id",
            "precedence": 7,
            "id": "policy-exclude-id",
            "name": "Exclude and Require",
            "decision": "allow",
            "include": [{"email": ["allowed@example.com"]}],
            "exclude": [{"geo": ["CN", "RU"]}],
            "require": [{"certificate": true}]
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "exclude_require",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "application_id": "app-ip-id",
            "precedence": 8,
            "id": "policy-ip-id",
            "name": "IP and Email Domain",
            "decision": "allow",
            "include": [{"ip": ["192.168.1.0/24", "10.0.0.0/8"], "email_domain": ["example.com", "company.org"]}]
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "ip_email_domain",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "application_id": "app-approval-id",
            "precedence": 9,
            "id": "policy-approval-id",
            "name": "Policy with Approval Group",
            "decision": "allow",
            "include": [{"everyone": true}],
            "approval_group": [{
              "approvals_needed": 2,
              "email_addresses": ["manager@example.com", "director@example.com"]
            }]
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_approval_group",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "application_id": "app-ssh-id",
            "precedence": 10,
            "id": "policy-ssh-id",
            "name": "SSH Policy with Connection Rules",
            "decision": "allow",
            "include": [{"everyone": true}],
            "connection_rules": [{
              "ssh": [{
                "usernames": ["admin", "deploy"],
                "allow_email_alias": true
              }]
            }]
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "with_connection_rules",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_access_policy"
    },
    {
      "instances": [
        {
          "attributes": {
            "account_id": "test-account-id",
            "zone_id": "zone-complex",
            "application_id": "app-complex-id",
            "precedence": 100,
            "id": "policy-complex-id",
            "name": "Complex Policy",
            "decision": "allow",
            "session_duration": "12h",
            "include": [{
              "everyone": true,
              "email": ["user1@example.com", "user2@example.com"],
              "group": ["group-1", "group-2"],
              "github": [{
                "name": "acme-corp",
                "teams": ["platform", "security", "devops"],
                "identity_provider_id": "idp-123"
              }]
            }],
            "exclude": [{
              "email_domain": ["competitor.com"],
              "geo": ["CN"]
            }],
            "require": [{
              "certificate": true,
              "group": ["mfa-enabled"]
            }],
            "approval_group": [{
              "approvals_needed": 3,
              "email_addresses": ["ceo@example.com", "cto@example.com"]
            }],
            "connection_rules": [{
              "ssh": [{
                "usernames": ["root", "admin"],
                "allow_email_alias": true
              }]
            }]
          },
          "schema_version": 0
        }
      ],
      "mode": "managed",
      "name": "complex",
      "provider": "provider[\"registry.terraform.io/cloudflare/cloudflare\"]",
      "type": "cloudflare_access_policy"
    }
  ],
  "serial": 1,
  "terraform_version": "1.5.0",
  "version": 4
}
